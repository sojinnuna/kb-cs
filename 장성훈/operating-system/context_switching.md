### 컨텍스트 스위칭(Context Switching)

컨텍스트 스위칭이란, 'CPU/코어에서 실행 중이던 프로세스/스레드가 다른 프로세스/스레드로 교체되는 것'입니다.
- 컨텍스트란 프로세스/스레드의 상태를 의미합니다. 또 이 상태라는 것은 CPU, 메모리에서의 상태를 의미합니다. 

### 동작과정
1. 현재 프로세스의 상태 저장
   - 현재 실행 중인 프로세스의 레지스터 값, 프로그램 카운터, 스택 포인터 등의 상태 정보를 PCB(Process Control Block)에 저장
2. 새로운 프로세스 선택
   - 운영 체제의 스케줄러가 실행할 다음 프로세스를 선택
3. 새 프로세스의 상태 복원
   - 선택된 프로세스의 상태 정보를 PCB에서 읽어와 레지스터, 프로그램 카운터, 스택 포인터 등에 복원
4. 프로세스 실행 재개
   - 새롭게 선택된 프로세스의 실행을 시작

### 프로세스와 스레드의 컨텍스트 스위칭 차이

- **프로세스 컨텍스트 스위칭**:
    - 전체 주소 공간, 페이지 테이블, 파일 디스크립터 등의 정보가 저장되고 로드
    - 상대적으로 많은 오버헤드가 발생
- **스레드 컨텍스트 스위칭**:
    - 동일한 프로세스 내에서 발생하므로 주소 공간과 파일 디스크립터 등을 공유
    - 스택 포인터와 프로그램 카운터 등 스레드별 레지스터 정보만 저장하고 로드
    - 프로세스 컨텍스트 스위칭보다 오버헤드가 적다.
    

### 컨텍스트 스위칭 시 정보 저장 형식

- 기존 프로세서의 정보는 프로세스 제어 블록(PCB)에 저장

  - 프로세스 ID
  - 프로세스 상태
  - 프로그램 카운터
  - CPU 레지스터 값
  - 메모리 관리 정보
  - 계정 정보
- 커널 스택에는 현재 프로세스의 스택 프레임과 레지스터 값이 저장

### 컨텍스트 스위칭이 발생 시기
| 발생 시기 | 설명 |
| --- | --- |
| 타임 슬라이스 종료 | 프로세스가 주어진 타임 슬라이스를 모두 사용하면 다른 프로세스로 전환 |
| 프로세스의 입출력 요청 | 프로세스가 입출력 작업을 요청하여 CPU가 다른 프로세스를 실행 |
| 인터럽트 발생 | 하드웨어 또는 소프트웨어 인터럽트가 발생하여 인터럽트 처리 루틴 실행 |
| 우선순위가 높은 프로세스 등장 | 우선순위가 높은 프로세스가 실행 준비 상태가 되어 CPU를 할당 |
| 프로세스 종료 | 현재 실행 중인 프로세스가 종료되어 다른 프로세스를 실행 |
| 자발적 양보 | 프로세스가 CPU를 더 이상 필요로 하지 않을 때 자발적으로 CPU를 양보 |
